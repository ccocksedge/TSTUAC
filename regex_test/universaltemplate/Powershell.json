{
    "agent": null,
    "agentCluster": null,
    "agentClusterVar": null,
    "agentFieldsRestriction": "No Restriction",
    "agentType": "Windows",
    "agentVar": null,
    "alwaysCancelOnFinish": false,
    "autoCleanup": false,
    "automaticOutputRetrievalFieldsRestriction": "No Restriction",
    "broadcastCluster": null,
    "broadcastClusterVar": null,
    "commands": [],
    "createConsole": false,
    "credentialFieldsRestriction": "No Restriction",
    "credentials": null,
    "credentialsVar": null,
    "description": "Run Powershell Script",
    "desktopInteract": false,
    "elevateUser": false,
    "environment": [],
    "environmentVariablesFieldsRestriction": "No Restriction",
    "events": [],
    "exitCodeOutput": null,
    "exitCodeProcessing": "Success Exitcode Range",
    "exitCodeProcessingFieldsRestriction": "No Restriction",
    "exitCodeText": null,
    "exitCodes": "0",
    "exportReleaseLevel": "7.4.0.0",
    "extension": null,
    "fields": [
        {
            "arrayFieldValue": [],
            "arrayNameTitle": null,
            "arrayValueTitle": null,
            "booleanNoValue": null,
            "booleanValueType": "true/false",
            "booleanYesValue": null,
            "choiceAllowEmpty": false,
            "choiceAllowMultiple": false,
            "choiceDynamic": false,
            "choiceFields": [],
            "choiceSortOption": "Sequence",
            "choices": [
                {
                    "fieldValue": "disk",
                    "fieldValueLabel": "Server Disk",
                    "sequence": 0,
                    "sysId": "b0eb10957d104693a3e29a8e9ccb88e7",
                    "useFieldValueForLabel": false
                },
                {
                    "fieldValue": "script",
                    "fieldValueLabel": "UC Script Library",
                    "sequence": 1,
                    "sysId": "5906d10f561b4951897f294ee1eb86a3",
                    "useFieldValueForLabel": false
                }
            ],
            "defaultListView": false,
            "extensionStatus": false,
            "fieldLength": null,
            "fieldMapping": "Choice Field 1",
            "fieldRestriction": "No Restriction",
            "fieldType": "Choice",
            "fieldValue": "script",
            "formColumnSpan": 1,
            "formEndRow": false,
            "formStartRow": true,
            "hint": "Specify if Powershell Script resides on the server or is in the UC Script Library",
            "intFieldMax": null,
            "intFieldMin": null,
            "label": "Powershell Script Location",
            "name": "location",
            "noSpaceIfHidden": false,
            "preserveOutputOnRerun": false,
            "preserveValueIfHidden": false,
            "requireIfField": null,
            "requireIfFieldValue": null,
            "requireIfVisible": false,
            "required": false,
            "sequence": 0,
            "showIfField": null,
            "showIfFieldValue": null,
            "sysId": "0b9f6057a6d246adb0a5c9be819e5d77",
            "textType": "Plain"
        },
        {
            "arrayFieldValue": [],
            "arrayNameTitle": null,
            "arrayValueTitle": null,
            "booleanNoValue": null,
            "booleanValueType": "true/false",
            "booleanYesValue": null,
            "choiceAllowEmpty": false,
            "choiceAllowMultiple": false,
            "choiceDynamic": false,
            "choiceFields": [],
            "choiceSortOption": "Sequence",
            "choices": [],
            "defaultListView": false,
            "extensionStatus": false,
            "fieldLength": null,
            "fieldMapping": "Script Field 1",
            "fieldRestriction": "No Restriction",
            "fieldType": "Script",
            "fieldValue": null,
            "formColumnSpan": 3,
            "formEndRow": false,
            "formStartRow": true,
            "hint": "Select the Powershell Script from the UC Script Library",
            "intFieldMax": null,
            "intFieldMin": null,
            "label": "Powershell Script",
            "name": "ucscript",
            "noSpaceIfHidden": true,
            "preserveOutputOnRerun": false,
            "preserveValueIfHidden": false,
            "requireIfField": null,
            "requireIfFieldValue": null,
            "requireIfVisible": true,
            "required": false,
            "sequence": 1,
            "showIfField": "Choice Field 1",
            "showIfFieldValue": "script",
            "sysId": "3c1893dfea5c4ab9b1fb2735a0e4b80a",
            "textType": "Plain"
        },
        {
            "arrayFieldValue": [],
            "arrayNameTitle": null,
            "arrayValueTitle": null,
            "booleanNoValue": null,
            "booleanValueType": "true/false",
            "booleanYesValue": null,
            "choiceAllowEmpty": false,
            "choiceAllowMultiple": false,
            "choiceDynamic": false,
            "choiceFields": [],
            "choiceSortOption": "Sequence",
            "choices": [],
            "defaultListView": false,
            "extensionStatus": false,
            "fieldLength": null,
            "fieldMapping": "Text Field 1",
            "fieldRestriction": "No Restriction",
            "fieldType": "Text",
            "fieldValue": null,
            "formColumnSpan": 3,
            "formEndRow": false,
            "formStartRow": true,
            "hint": "Fully qualified Powershell Script Name",
            "intFieldMax": null,
            "intFieldMin": null,
            "label": "Powershell Script Location",
            "name": "script",
            "noSpaceIfHidden": true,
            "preserveOutputOnRerun": false,
            "preserveValueIfHidden": false,
            "requireIfField": null,
            "requireIfFieldValue": null,
            "requireIfVisible": true,
            "required": false,
            "sequence": 2,
            "showIfField": "Choice Field 1",
            "showIfFieldValue": "disk",
            "sysId": "d3157c511a0f4d3e9c87251d47e937b3",
            "textType": "Plain"
        },
        {
            "arrayFieldValue": [],
            "arrayNameTitle": "Option",
            "arrayValueTitle": "Value",
            "booleanNoValue": null,
            "booleanValueType": "true/false",
            "booleanYesValue": null,
            "choiceAllowEmpty": false,
            "choiceAllowMultiple": false,
            "choiceDynamic": false,
            "choiceFields": [],
            "choiceSortOption": "Sequence",
            "choices": [],
            "defaultListView": false,
            "extensionStatus": false,
            "fieldLength": null,
            "fieldMapping": "Array Field 1",
            "fieldRestriction": "No Restriction",
            "fieldType": "Array",
            "fieldValue": null,
            "formColumnSpan": 3,
            "formEndRow": false,
            "formStartRow": true,
            "hint": null,
            "intFieldMax": null,
            "intFieldMin": null,
            "label": "Powershell Script Options",
            "name": "options",
            "noSpaceIfHidden": false,
            "preserveOutputOnRerun": false,
            "preserveValueIfHidden": false,
            "requireIfField": null,
            "requireIfFieldValue": null,
            "requireIfVisible": false,
            "required": false,
            "sequence": 3,
            "showIfField": null,
            "showIfFieldValue": null,
            "sysId": "662f8dac821740aa8481af1ec286e9af",
            "textType": "Plain"
        }
    ],
    "logLevel": "Inherited",
    "name": "Powershell",
    "outputConditionOperator": "=",
    "outputConditionStrategy": "Match Any",
    "outputConditionValue": null,
    "outputContentType": null,
    "outputFailureOnly": false,
    "outputPathExpression": null,
    "outputReturnFile": null,
    "outputReturnNline": "100",
    "outputReturnSline": "1",
    "outputReturnText": null,
    "outputReturnType": "NONE",
    "outputType": "STDOUT",
    "runtimeDir": null,
    "script": null,
    "scriptTypeWindows": "uapy",
    "scriptUnix": null,
    "scriptWindows": "#!/opt/universal/python/bin/python\nimport subprocess,sys,os\noptions = \"${_convertArrayFieldVariable(\"ops_ps1_options\",\"=\",\" \")}\"\noptions = options.replace(\"=\",\" \")\nif \"${ops_ps1_location}\" == \"script\":\n    script=r\"${_scriptpath('${ops_ps1_ucscript}')}\"\nelse:\n    script=r\"${ops_ps1_script}\"\ncommand = subprocess.run('powershell -File \"{0}\" {1}'.format(script,options), shell=True, stderr=subprocess.PIPE, stdout=subprocess.PIPE)\nos.write(1, command.stdout)\nos.write(2, command.stderr)\nsys.exit(command.returncode)",
    "sendVariables": "None",
    "sysId": "09f0819c500b4475b70ed7e3d876968a",
    "templateType": "Script",
    "useCommonScript": false,
    "variablePrefix": "ps1",
    "waitForOutput": false
}